<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="【斯坦福cs224w-图机器学习】8-Graph Neural Networks, 杨程的博客">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer" />
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>【斯坦福cs224w-图机器学习】8-Graph Neural Networks | 杨程的博客</title>
    <link rel="icon" type="image/png" href="/myicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <span class="logo-span">杨程的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <div class="logo-name">杨程的博客</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('http://ww1.sinaimg.cn/large/9b63ed6fgy1gkra5zwiqdj20w60eljsn.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">【斯坦福cs224w-图机器学习】8-Graph Neural Networks</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/GNN/">
                                <span class="chip bg-color">GNN</span>
                            </a>
                        
                            <a href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">课程笔记</span>
                            </a>
                        
                            <a href="/tags/cs224w/">
                                <span class="chip bg-color">cs224w</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/GNN/" class="post-category">
                                GNN
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-11-26
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><img src="https://pic1.zhimg.com/80/v2-338272ff7d5ed60dd67f5cb531d0afd0_720w.jpg"></p>
<h2 id="复习Node-Embeddings"><a href="#复习Node-Embeddings" class="headerlink" title="复习Node Embeddings"></a>复习Node Embeddings</h2><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><p><font color="red">将图中的节点映射到d-维度嵌入空间，使得图中的<strong>相似的节点</strong>在d-维度嵌入空间中紧密地<strong>相邻</strong>。</font>即要使得$similarity(u,v) \approx z_u^{T}z_v$。</p>
<blockquote>
<p>这里的“相似的节点”并不是指在原空间相邻，相似（similarity）的定义有很多种，除了相邻，如果两个节点在图中承担了相同的structure role，它们也可以称作是相似的。</p>
</blockquote>
<p><img src="https://pic2.zhimg.com/80/v2-de441b95f0d25cfab8b4931fcca81365_720w.jpg"></p>
<p><img src="https://pic3.zhimg.com/80/v2-56fcfef9a32472ffbb01fa663bd356be_720w.jpg"></p>
<p>完成Node Embedding需要定义两个东西：</p>
<ol>
<li></li>
</ol>
<p><img src="%E3%80%90%E6%96%AF%E5%9D%A6%E7%A6%8Fcs224w-%E5%9B%BE%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E3%80%918-Graph-Neural-Networks/v2-814f105bd80f0c22b103bcbb7ecae18d_720w.jpg"></p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>从Node Embedding的目的的定义中，我们可以抽取出实现Node Embedding的两个重要组件：</p>
<ol>
<li><strong><code>Encoder</code>函数</strong></li>
<li><strong>input network上节点<code>similarity</code>的度量方式</strong></li>
</ol>
<p><img src="https://pic1.zhimg.com/80/v2-95c2ed92986bbeb1edd60c04f589d1c0_720w.jpg"></p>
<blockquote>
<p>这里的<code>dot product</code>$z_v^Tz_u$其实最后计算的是<strong>余弦距离</strong>，余弦距离是一种常见的相似度度量方式。</p>
</blockquote>
<h3 id="实现方式一：Shallow-Node-Embedding"><a href="#实现方式一：Shallow-Node-Embedding" class="headerlink" title="实现方式一：Shallow Node Embedding"></a>实现方式一：Shallow Node Embedding</h3><p>我们之前所提到的<code>DeepWalk</code>也好，<code>node2vec</code>也好，都属于浅层的encoders。它们的作用类似是建立了一张Hash Table，如下图：</p>
<p><img src="https://pic2.zhimg.com/80/v2-1c4527985f9cc47399bb1a0aa9abd2d5_720w.jpg" alt="img"></p>
<p>这些内容第七课实际上都已经介绍过了，所以就不赘述了。</p>
<p><img src="https://pic3.zhimg.com/80/v2-01b4bbb1874cbf8455652e7676be0eae_720w.jpg"></p>
<h4 id="局限性——即为什么要引入Graph-Neural-Network？👏"><a href="#局限性——即为什么要引入Graph-Neural-Network？👏" class="headerlink" title="局限性——即为什么要引入Graph Neural Network？👏"></a>局限性——即为什么要引入Graph Neural Network？👏</h4><p><img src="https://pic4.zhimg.com/80/v2-ab45604f5ad2f562177c9445ab9cf5bb_720w.jpg"></p>
<p>那么浅层的encoders有哪些缺陷呢？</p>
<ol>
<li><p><strong>太多参数</strong>：v个节点就有v个embedding，并且nodes之间不共享参数，每一个node都有其独立的embedding，那么如果embedding的维度是100，有100万个节点，我们就要训练1亿个参数。</p>
</li>
<li><p><strong>固有的局限性</strong>： 无法为训练期间未见的节点生成embedding，这就好比word2vec对于未见过的词无法进行embedding一样；woe对于没见过的类别无法编码一样；除此之外，当我们在一个网络上训练得到了各个节点的embedding，然后比如时间长了，网络里又增加了很多新的节点和边，那么我们又得重新训练一次，</p>
</li>
<li><p><strong>压根没用上node的feature啊</strong>：我们在cs224w第七课中，DeepWalk和node2vec压根没有用到每一个节点的属性特征，<strong>它们只是使用了图结构信息</strong>，比如某个user的节点，会有age、gender之类的特征，我们在embedding的时候也应该将这些考虑尽量，因为如果两个节点的属性完全相同很可能也代表了这两个节点非常接近，所以他们在embedding的空间里按理说也应该接近。</p>
</li>
</ol>
<p>除了要解决上面的这些问题之外，还有一个问题：</p>
<blockquote>
<p>Spectral Clustering可以看作是一种Embedding，它是人工数学推导计算出来的用于聚类的Embedding。（其数学推导是为了近似最大化conductance！）</p>
<p>那如果我们想，如果我要进行一个链路预测问题的话，难道我又要另外自己去公式推导找Embedding？如果我要进行一个分类问题的话，我又要找另外一个Embedding？难道我们就不能训练一个模型，这个模型能够根据任务的特征，自动得到Embedding？</p>
</blockquote>
<p>那么这里就是GNN大展身手的时候了！</p>
<h3 id="实现方式二：Deep-Node-Embedding"><a href="#实现方式二：Deep-Node-Embedding" class="headerlink" title="实现方式二：Deep Node Embedding"></a>实现方式二：Deep Node Embedding</h3><h4 id="Shallow-Node-Embedding-vs-Deep-Node-Embedding"><a href="#Shallow-Node-Embedding-vs-Deep-Node-Embedding" class="headerlink" title="Shallow Node Embedding vs. Deep Node Embedding"></a>Shallow Node Embedding vs. Deep Node Embedding</h4><p><img src="https://pic3.zhimg.com/80/v2-f07200b5fcf80779f48e2cb6ac79774a_720w.jpg"></p>
<p>所有的deep encoders都可以和上一节课我们介绍的<code>node similarity functions</code>结合起来，即：</p>
<ul>
<li><strong>Adjacency-based（即如果两个节点连通，那么它们相似）</strong></li>
<li><strong>Multi-hop similarity definitions</strong></li>
<li><strong>Random walk approaches</strong></li>
</ul>
<p><img src="https://pic2.zhimg.com/80/v2-806fe1a8de0fc3db8290573fb826b45d_720w.jpg"></p>
<p>上一节课我们这里的$ENC(V)$如下：</p>
<p><img src="https://pic1.zhimg.com/80/v2-3bb7c01b3052d94475f17a42f96a1690_720w.jpg"></p>
<blockquote>
<p>这个地方其实我一直在概念上比较困惑，因为总是不自觉地联想到DNN和CNN，在普通的深度学习的领域里，DNN是普通的全连接层，CNN则是带有卷积层和池化层的特殊结构，二者应该是两种不同的结构所以总是误以为有一种GNN的图网络结构和一种GCN的图网络结构。。。实际上这里的GNN指代的是nn的概念，即CNN属于nn的一种，GCN属于GNN的一种。另一方面，<strong>GCN有广义和狭义之分</strong>：</p>
<p><img src="https://pic1.zhimg.com/80/v2-d3f9db91a8e5c246cd4243bf03a9532c_720w.jpg"></p>
</blockquote>
<p>这节课谈到的GCN属于狭义的GCN，也就是上图最右边的那个。这也是2017年的论文《semi-supervised classification with GCN》里所谈到的结构，是目前我们经常谈论到的那种GCN。</p>
<h4 id="已有机器学习的局限性——研究GNN的原因"><a href="#已有机器学习的局限性——研究GNN的原因" class="headerlink" title="已有机器学习的局限性——研究GNN的原因"></a>已有机器学习的局限性——研究GNN的原因</h4><p><img src="https://pic3.zhimg.com/80/v2-e20062c927ba80aadd3c715b546b0bca_720w.jpg"></p>
<p><img src="https://pic3.zhimg.com/80/v2-27ded1135bc6632435e55ac7db325662_720w.jpg"></p>
<p>这些实际上都是综述里的内容，这里引出了为什么我们使用常规的NN结构无法处理图数据：</p>
<ol>
<li><p>图中的节点没有固定的顺序或参考系，而我们使用CNN或RNN所面对的数据都是fixed size，固定大小的，每一张图片的大小都处理成完全一样的，每一个序列都会通过补零然后mask从而达到同样size的效果；</p>
</li>
<li><p>网络常常是动态的并且具有多模态特征；</p>
</li>
</ol>
<h4 id="从计算机视觉到图神经网络"><a href="#从计算机视觉到图神经网络" class="headerlink" title="从计算机视觉到图神经网络"></a>从计算机视觉到图神经网络</h4><p><img src="https://pic3.zhimg.com/80/v2-51f7c2b0ad15f7852c71ad533e31c492_720w.jpg"></p>
<p>我们希望能够将CNN中<font color="red"><strong>卷积</strong></font>的思想推广到网格结构之外，同时充分利用节点原有的属性（例如文本或图像）。</p>
<blockquote>
<p>你甚至可以认为结点不同的feature作为convolution操作里面不同的channel。</p>
</blockquote>
<p><strong>（这里建议看下gnn的综述，里面详细介绍了图像和文本都属于图数据结构的一种）</strong></p>
<p>将图像转变为图结构进行思考：</p>
<p><img src="https://pic4.zhimg.com/80/v2-363f4b11b8581f8c6cf8fdcd304aaa0f_720w.jpg"></p>
<p>上图左边为一个简单的3X3的卷积核，其计算的本质就是对$W_i*h_i$进行求和。比如原图中的9个像素点$h_i$代表了9个输入，每个输入对应一个$W_i$，即连接权，然后进行加权求和再进入activation function。</p>
<p>我们前面提到过图像属于图数据的一种，因此这里也可以从图数据的角度来描述，如右图，因为$CNN$传播的时候所有节点都参与了加权求和，对应到图上就是中心节点再加一个自循环进来，这样实际上右图也一样可以表示为加权求和的形式。这样我们就把$CNN$的输入转化为用图来描述。</p>
<blockquote>
<p>但是，需要辨别的是：在CNN中，聚合的单位是特征；而在GNN中，聚合的单位是节点。特征和节点的粒度大小是不一样的！所以我认为只能说GNN是利用了CNN这种聚合的思想，而不是完全照搬CNN的模型~🤔</p>
</blockquote>
<p>这样我们就可以用常规$CNN$处理这种规整的图数据了，然而：</p>
<p><img src="https://pic3.zhimg.com/80/v2-2d0cdcb7b250a787f59b12729c29c5ce_720w.jpg"></p>
<p>现实中的网络复杂的多，比如上面这样形式的图，就没办法用CNN来处理的。。。</p>
<p>这种结构别说CNN，目前我们常见的模型都无法接受这种形式的数据作为输入，</p>
<p><font color="red"><strong>所以我们该怎么做才能像在图像上使用卷积层来slide（卷积层按照步长滑动）那样在graph的数据上slide呢?</strong></font></p>
<h4 id="一种简单的方法——没看懂"><a href="#一种简单的方法——没看懂" class="headerlink" title="一种简单的方法——没看懂"></a>一种简单的方法——没看懂</h4><p><img src="https://pic2.zhimg.com/80/v2-29de3154e5da90640ecbfd56c080a655_720w.jpg"></p>
<p>一个简单的思路，我们把图转化为其领接矩阵的形式，然后这个邻接矩阵和node的属性组成的特征矩阵合并（concat）在一起，如上图，这样就转化为一个规整的二维矩阵了，这样我们就可以用一个普通的nn结构或lr、gbdt之类的算法来处理了；</p>
<p>然而这种做法的坏处也很明显：</p>
<ol>
<li><p>如果node的数量非常多，那么最终的合并矩阵的维度会非常大，高维稀疏的情况下非常容易过拟合；</p>
</li>
<li><p>这种情况下训练出来的模型对于不同size的网络用不了。比如我们原来是100个node，扩展成100维加上原来计入50维的node feature一共150维，然后我们训练一个nn，这个nn只能接受150维的输入，然后新的网络有500个node，concat之后是550维，这样我们就面临了输入数据的异构问题了；</p>
</li>
<li><p>显然破坏了图的结构信息，比如A和E是二度关联的，但是转换成领结矩阵之后我们无法直接观察到这种关联；</p>
</li>
<li><p>这里提到了第四点，就是比如我们保持原始的图结构不变，然后变换了node的位置，但是领域信息是完全不变的（建议自己把node换一下然后看看每个节点的领域关系是否改变就知道了）但是其领接矩阵确发生了变化，显然我们希望这种变化对于模型来说没有影响。</p>
</li>
</ol>
<h2 id="GCN"><a href="#GCN" class="headerlink" title="GCN"></a>GCN</h2><p>GNN的兴起，是以GCN模型的提出为标志的，所以我们学习GCN能够让我们了解一些GNN的入门知识。</p>
<h3 id="Preliminaries"><a href="#Preliminaries" class="headerlink" title="Preliminaries"></a>Preliminaries</h3><p><img src="https://pic2.zhimg.com/80/v2-09145283e9e3b99a1a6a547bd66467fd_720w.jpg"></p>
<p>我们给定一个图结构：</p>
<ul>
<li>$V$是节点的集合；</li>
<li>$A$是图的邻接矩阵；</li>
<li>$X$是节点的属性矩阵组成的特征矩阵（维度有点意思~）</li>
</ul>
<p>不同网络有不同的<code>node features</code>，比如：</p>
<ul>
<li><p><strong>社交网络</strong>：用户信息与用户画像等；</p>
</li>
<li><p><strong>生物网络</strong>：基因表达谱、基因功能信息</p>
</li>
<li><p><strong>数字特征</strong>：指示向量（节点的独热编码）</p>
</li>
</ul>
<h3 id="GCN的idea⭐⭐⭐⭐⭐"><a href="#GCN的idea⭐⭐⭐⭐⭐" class="headerlink" title="GCN的idea⭐⭐⭐⭐⭐"></a>GCN的idea⭐⭐⭐⭐⭐</h3><p>GNN的思想：<font color="red"><strong>Generate Embedding by Aggregating Neighbors‘ Embedding Through Computation Graph</strong></font></p>
<p>顾名思义，我们需要解决两个问题：</p>
<ol>
<li><p>how to capture computation graph？</p>
</li>
<li><p>how to aggregate information？</p>
</li>
</ol>
<blockquote>
<p>很多基于GCN的优化也是从这两个方面出发的。</p>
</blockquote>
<h4 id="Computation-Graph"><a href="#Computation-Graph" class="headerlink" title="Computation Graph"></a>Computation Graph</h4><p><img src="https://pic3.zhimg.com/80/v2-e170eb706dff414655c96d56536ca1aa_720w.jpg"></p>
<p>上图中的橙色部分就是经过对节点$i$的邻域采样后的得到的Computation Graph。</p>
<p>这里我们希望学习如何通过图的结构来<strong>传播信息（Message Passing）</strong>从而更好地计算节点的embedding，<font color="red"><strong>说白了就是不仅像node2vec那些算法那样考虑节点和节点之间的关联关系还要考虑节点的属性（特征）。</strong></font></p>
<p>上图的<code>k=1</code>表示一度关联，<code>k=2</code>表示二度关联 。比如node $i$，我们后面介绍的方法不仅能够捕获到node $i$ 所在图的结构信息，还能够捕获node $i$ 的邻节点的属性信息从而增强embedding的表达能力。</p>
<p><img src="https://pic4.zhimg.com/80/v2-e479954bdaf518814bb9a000f73a3e87_720w.jpg"></p>
<p><font color="red">通常来说这个<strong>聚合邻居的操作</strong>（也就是这个彩色的层数，如上图中有两层）是不需要叠很多层的，因为著名的6度理论告诉我们，走了6层邻居差不多就可以遍历到图中的每一个节点了。但是黑色盒子里面的DNN是可以叠很多层的！</font></p>
<p>这里就看的非常明白了，例如我们要计算$A$的embedding，我们希望能够collect来自$B$、$C$、$D$的信息，而$B$、$C$、$D$又分别collect来自其各自的领域的信息，这里可能有点懵逼，那么所有Nodes最原始的属性（即之前提到的user profiles，images之类的属性）到底是在哪里参与了这个网络结构，答案就是</p>
<p><img src="https://pic3.zhimg.com/80/v2-496d99e9b6f5b2a54d70a3f3cc892476_720w.png" alt="img"></p>
<p><strong>here，这里是layer-0，第0层，这里的输入都是节点的属性</strong>。这样我们就巧妙的把node A的邻节点的属性考虑进来了，同时node A所在的网络的结构也一并考虑进来了，因为不同的结构会使得最终embedding的结果不同，通过这种方式捕获的结构的信息。</p>
<blockquote>
<p>（这里学生问了一个我也想问的问题，如果说整个网络非常复杂，A的邻居节点B存在邻节点C，而邻节点C存在一个更远的邻节点D，邻节点D存在一个更更远的邻节点E，那么我们是不是也要统一考虑进来，这里教授的答案是“no need”。。。。额。。。）</p>
</blockquote>
<p><img src="https://pic4.zhimg.com/80/v2-e5669b607992ae1439f2556130035c0b_720w.jpg"></p>
<ul>
<li><p>到这里还有一个问题，这些黑色的<code>box</code>到底是什么东西？</p>
<p>关于<code>box</code>，我们目前只知道有一点性质，它需要满足，就是这个<code>box</code>中的函数对于输入节点的顺序是完全不敏感的，比如第一个灰色<code>box</code>的输入是$A$和$C$节点，我们替换$A$和$C$的顺序之后，经过这个<code>box</code> function之后的结果应该是不变的。<strong>这个function应该是order invariant function（目的是为了解决上面讲的对顺序敏感的问题）</strong>，具体后面会描述清楚的。</p>
</li>
</ul>
<p><img src="https://pic1.zhimg.com/80/v2-a0127dd305b11831f4b00f3405b3f164_720w.jpg"></p>
<p>那么通过刚才的思路，我们为每一个节点都进行了上面所说的展开的方法进行展开得到了上图。可以发现，每个结点拥有不同的Computation Graph。</p>
<p>怎样初始化，以及怎样计算：</p>
<p><img src="https://pic1.zhimg.com/80/v2-3b5eeaedd1efa5c79e6720500a763ddc_720w.jpg" alt="img"></p>
<p>这里整个Deep Graph Encoder的结构就出来了，我们的输入是target node的二阶邻居节点，输出是target node的embedding。</p>
<p>需要注意，以节点$C$为例，layer-0节点$C$是$C$的原有的features，比如$C$是一个用户，那么就可能是用户的age、gender、nationality等，但是除了layer-0之外，其它的layer里，$C$都是该层对应的embedding。这是一个很奇怪很有意思的地方。</p>
<p>其实这里涉及到了两种思维方式——<strong>Top to Down</strong> 和 <strong>Down to Top</strong>（有点类似于递归的思想）：</p>
<ul>
<li><strong>Top to Down</strong>：是我们得到计算图的过程，类似于递归函数不断递归深入的过程。给定节点$u$，如果我们要聚合它的二阶以内邻居的信息，我们首先得到它的一阶邻居，然后通过一阶邻居的一阶邻居得到它的二阶邻居。过程类似于从左到右看上面的网络图。</li>
<li><strong>Down to Top</strong>：是我们聚合邻居信息的过程，类似于递归函数不断返回的过程。同样是上面那个例子，首先是二阶邻居将自己的信息聚合到对应的一阶邻居，然后一阶邻居再聚合到节点$u$。过程类似于从右到左看上面的网络图。这是我们的网络计算的顺序。</li>
</ul>
<p>可以思考，以上两个过程的确能够确保节点$u$能够聚合到二阶邻居以内的所有信息。</p>
<p>上图是一个二层的结构（这里的层数是<code>box</code>​代表了层，并不是指Deep Neural Network里面的层数），这意味着我们取的是node $A$的2 hops away的邻节点，这里又提到了为什么我们不继续”go deep“的问题，如果我们考虑太远的节点，会把太多的结构信息考虑进来，举一个极端的例子，比如我们go 20 steps deeper，可能会把整个网络结构的信息考虑进来。</p>
<blockquote>
<ul>
<li>（这里是我自己的思考，我们以word2vec为例，假设一个句子有10个单词，而我们的windows是10，这就意味着在这个句子中，每个单词的embedding表示最终都是由这个句子中所有的单词一同参与训练的，这会导致最终这个句子中所有的单词训练出来的embedding接近一致，这显然不是我们想要的结果。）</li>
<li>但是这并不意味着你不能做很深的Deep Neural Network！我们完全可以让$<code>box</code>$里面的DNN非常深~</li>
</ul>
</blockquote>
<p>另外，假设我们图中的F直接又接入了一个G，这个G仅仅和F连接而不和其它所有的已知节点有连接，那么我们就要在F的屁股后面接入一个<code>box</code>，这个<code>box</code>的输入是F的邻节点E、C、G。</p>
<p>btw，问了一下，之所以我们不go太过deeper，一方面引入太多的领域信息：</p>
<p><img src="https://pic2.zhimg.com/80/v2-c6fc85c57ef9bdc6258329f245f562d5_720w.jpg" alt="img"></p>
<p>90%的nodes会在8hops之内访问到，因此这意味着hops取得太大，会导致最终每个节点的embedding的计算过程中，输入的features几乎差不多，从而最终导致over-smooth的问题，即每个节点最终计算出来的embedding接近一致。</p>
<p>这类似于我们使用word2vec对一篇文章中的每个词进行向量化，windows取得太大使得整篇文章的词语都参与了每一个词的embedding训练——换句还说，每个词都在每个词的附近。。。最终结算的结果当然是所有的embedding都差不多了。。。</p>
<p><img src="https://pic1.zhimg.com/80/v2-f95db64e7eb618a8279543e08acdd4d8_720w.jpg" alt="img"></p>
<h4 id="Aggregation-Function"><a href="#Aggregation-Function" class="headerlink" title="Aggregation Function"></a>Aggregation Function</h4><p>现在一个重要的地方在于我们如何汇总各层的信息？做基本的思路如下：</p>
<p><img src="https://pic2.zhimg.com/80/v2-3d216fbdf25a72c8977ba58aee455909_720w.jpg" alt="img"></p>
<p>最简单的思路，我们把所有来自于邻域的信息进行平均然后输入一个$NN$结构即可；注意，所有的<code>box</code>都是这样的，箭头的地方先进行average，然后送到一个$NN$的结构里。也就是<code>box</code>前面的箭头是average，<code>box</code>里面是一个$NN$。</p>
<p>把整个过程用公式来表示就是：</p>
<p><img src="https://pic1.zhimg.com/80/v2-0379221b6a3be49372a232c88dc13a48_720w.jpg" alt="img"></p>
<p>这个过程用公式来表示如上图，这就是狭义的GCN的整个前向传播的过程了。这里，如果$W_k$全是0，则意味着我们根本不考虑邻节点的信息，这个时候这个GCN的结构就退化成了普通的MLP（DNN）。如果$W_k$非常非常大，$B_k$相对非常非常小，则相当于我们只考虑了邻节点信息而忽略了自身的信息。具体应该怎么去分$W_k$和$B_k$的大小，是由<font color="red"><strong>整个模型训练的过程中自己决定的</strong></font>。</p>
<h4 id="Training-the-Model"><a href="#Training-the-Model" class="headerlink" title="Training the Model"></a>Training the Model</h4><p><img src="https://pic4.zhimg.com/80/v2-ce4bcc92f33a8d65c8520dfeefd42043_720w.jpg" alt="img"></p>
<p>这里我们定义完了前向传播的过程，还缺一个损失函数。</p>
<p><img src="https://pic1.zhimg.com/80/v2-b7a2fa86319d8e28369c0c942822d9b4_720w.jpg"></p>
<ul>
<li>这里，我们把上面的公式表达成<strong>矩阵</strong>的形式，如上图，其中$H(l+1)$表示所有node的在$l+1$层的embedding表示，$H(l)$同理，$A$表示graph的领接矩阵，$D$表示graph的度矩阵，关于graph常用的矩阵的含义可见：<a href="https://link.zhihu.com/?target=https://blog.csdn.net/weixin_43330946/article/details/102802768">GNN之常用矩阵汇总</a></li>
<li>这里的$W_k$和$B_k$可以用于衡量邻居和自己的作用的大小。</li>
</ul>
<h5 id="无监督方式"><a href="#无监督方式" class="headerlink" title="无监督方式"></a>无监督方式</h5><p><img src="https://pic2.zhimg.com/80/v2-5d14a6d2184257209e29649bcff39cb5_720w.jpg"></p>
<p>损失函数可以使用<code>random walks</code>定义的损失函数也可以用<code>graph factorization</code>或者<code>node proximity</code>的损失函数。比如第七课用过的：</p>
<p><img src="https://pic2.zhimg.com/80/v2-8031dd9bdddc204a162e6725af9e3e81_720w.jpg" alt="img"></p>
<p>这样损失函数也确定下来惹~，我们就在自动微分的框架下快乐的等待整个网络训练到收敛为止。</p>
<h5 id="有监督方式"><a href="#有监督方式" class="headerlink" title="有监督方式"></a>有监督方式</h5><p>除此之外，我们可以直接在最终的输出上接一个分类层，然后使用分类的损失函数比如<strong>交叉熵</strong>作为最终的损失函数。</p>
<p><img src="https://pic3.zhimg.com/80/v2-1b426366c3d3c3d2be95bfbecf592622_720w.jpg" alt="img"></p>
<p><img src="https://pic4.zhimg.com/80/v2-6af4e8a2bfcf2ffbbaa503aaad88db43_720w.jpg" alt="img"></p>
<p>这里公式写的非常明了了。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>下面进行了一个完整的总结：</p>
<p><img src="https://pic4.zhimg.com/80/v2-58331aa6bf9830a75b8769710281807b_720w.jpg" alt="img"></p>
<ol>
<li><p>我们定义一个neighborhood aggregation function，狭义的GCN使用的就是简单平均的策略；</p>
</li>
<li><p>我们定义一个funtion用于指导GCN进行反向传播更新权重参数W和B；</p>
</li>
</ol>
<p><img src="https://pic3.zhimg.com/80/v2-e4e178c1890d901beb297a3c31997cde_720w.jpg" alt="img"></p>
<ol start="3">
<li><strong>一个节点对应一个模型输入的样本</strong>，我们在这些样本上进行训练；</li>
</ol>
<p><img src="https://pic4.zhimg.com/80/v2-f42e8fb1942e2decf7dfd7245c3dbee3_720w.jpg" alt="img"></p>
<p>假设我们的训练集是node $A$、node $B$和node $C$，那么我们直接可以把训练完的model用于预测未见过的node $B$、$E$、$F$，这里就比较重要了，首先我们训练完毕的模型是什么样子的？</p>
<p>实际上我们训练完毕的model就是**两个<code>box</code>**：</p>
<p><img src="https://pic2.zhimg.com/80/v2-d2dd20edbe84abce89ec038895850e95_720w.jpg" alt="img"></p>
<p>一个是浅灰色的<code>box</code>，一个是深灰色的<code>box</code>，这两个<code>box</code>都是$NN$的结构，具体是什么结构可以自己用普通的神经网络的方法来定义。另一个重要的地方在于，可以看到深灰色的<code>box</code>有3个，实际上只有一个，这3个浅灰色<code>box</code>进行了权值共享，是不是和CNN里的卷积核非常相似？实际上CNN里的卷积核的传播形式展开之后也可以表示成上面的形式的。</p>
<p>所以，对于new node，我们可以很轻易的使用已经训练完的两个<code>box</code>来进行预测得到最终的结果。</p>
<p>见下：</p>
<h5 id="inductive-capability"><a href="#inductive-capability" class="headerlink" title="inductive capability"></a>inductive capability</h5><p>归纳能力</p>
<p><img src="https://pic1.zhimg.com/80/v2-f9adcb6fe13068709d43f24e361aac64_720w.jpg" alt="img"></p>
<p>我们最终share的权重如上图，这里就是体现$GNN$权值共享的地方。可以看到，相对于node2vec和deepwalk这种算法，deep graph encoders可以对unseen的node进行embedding，而node2vec和deepwalk无法实现这样的功能，并且deep graph encoders还考虑了node的features，使得最终的embedding结果更加expressive。</p>
<p>不仅如此，即使是新的graph结果，我们也可以直接apply原来的model了！简直太牛逼了！！</p>
<p><img src="https://pic1.zhimg.com/80/v2-47740995df57d3572f1cb06446ded854_720w.jpg" alt="img"></p>
<blockquote>
<p>上面的例子很赞👍</p>
</blockquote>
<p><img src="https://pic3.zhimg.com/80/v2-85f70177567e2688f83d7ba120392f0e_720w.jpg"></p>
<p><strong>还有一个非常有用的地方就是，你可以只训练一个子图，就可以获取这个全局的信息。</strong>但是这个采样子图一定要保证良好的随机性！！！</p>
<p><img src="https://pic3.zhimg.com/80/v2-5f51ef654d2ad235c597bd903bfaa18e_720w.jpg" alt="img"></p>
<p>需要区别聚合信息的depth和深度学习的depth。你完全可以让你的黑盒子非常的deep，因为一个黑盒子就是一个deep neural network，这个可以联想的~</p>
<hr>
<p>这样我们就从graph embedding过渡到了GCN，这也是我认为最好理解的方式了，后面补充一下graphsage的内容，关于gat，我得去复习下attention的内容，后面佛系更新了。</p>
<p><img src="https://pic2.zhimg.com/80/v2-425604b98f62b7a519d886198daace35_720w.jpg" alt="img"></p>
<p>这里实际上我们就实现了在graph上slide，这两个<code>box</code>就是我们的“卷积核”，我们取2 hops away的节点进行展开，就类比于固定了“卷积核”的size，比如我们从D开始slide，“卷积核”的size（这里的卷积核取双引号因为是类比的关系，不是真正指cnn里的卷积核的概念），取其2hops away的节点展开成一个computation graph，得到了上面第四个图，然后我们slide到节点A，取其2hops away的邻节点，展开成一个computation graph图，得到上面第一个图。。。。。依次类推，可以看到，实际上类似于我们把每一个node当作cnn中卷积核的中心的像素点~。</p>
<hr>
<h2 id="GraphSAGE"><a href="#GraphSAGE" class="headerlink" title="GraphSAGE"></a>GraphSAGE</h2><h3 id="GraphSAGE的提出原因"><a href="#GraphSAGE的提出原因" class="headerlink" title="GraphSAGE的提出原因"></a>GraphSAGE的提出原因</h3><p>从GCN过渡到GraphSAGE的过程是非常自然，二者的不同之处仅仅是<code>box</code>处做了一些修改：</p>
<p><img src="https://pic2.zhimg.com/80/v2-252e5eb0dc002dd7956b77647c6202f5_720w.jpg"></p>
<p>这里提到了weighted average，实际上指的就是当图为带权图的时候，我们进行average之前，每个节对应的要乘上edge的权重再平均，这实际上也是很好理解的，比如我认识很多大佬，但是大佬们都不认识我，所以他们收入高跟我可能没什么关系，我们之间的edge的权重可能是0.001。。。</p>
<p><img src="https://pic4.zhimg.com/80/v2-9b591856199e4690cd3b3dca0f6af10f_720w.jpg"></p>
<p>比较一下：</p>
<p><img src="https://pic2.zhimg.com/80/v2-3f346fa4266b61f5ce70ace8790c8a85_720w.jpg" alt="img"></p>
<p>主要有两个不同：</p>
<ol>
<li>邻域信息和自身信息的结合从代数运算变成了concatenate（这样能够让节点自身的信息与邻域的信息区分开来）；</li>
<li>不使用简单的mean函数作为聚合函数，而是使用Generalized的聚合函数。这里，我们从广义的角度上来定义聚合函数，即我们在GCN中使用的是简单的邻居的聚合，而在<code>GraphSAGE</code>中，这个聚合函数的形式更加多样：</li>
</ol>
<h3 id="不同聚合函数的性质"><a href="#不同聚合函数的性质" class="headerlink" title="不同聚合函数的性质"></a>不同聚合函数的性质</h3><p><img src="https://pic4.zhimg.com/80/v2-b3dfc3976ef6bc0aa4de4a7a10fa53af_720w.jpg"></p>
<p>我们可以使用原来的mean的策略；也可以使用pooling的策略；甚至可以加一个LSTM进来，只不过因为LSTM是序列相关的，而我们的节点是无序的，所以处理方法就是对节点进行几次shuffle，每次shuffle的结构都当作一个有order的序列然后传入LSTM进行训练；</p>
<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m61svcfj22bc1qindx.jpg">

<h3 id="实现聚合操作的矩阵运算"><a href="#实现聚合操作的矩阵运算" class="headerlink" title="实现聚合操作的矩阵运算"></a>实现聚合操作的矩阵运算</h3><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m61y6q2j22bc1qitk4.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m64vwz2j22bc1qiaq0.jpg">

<h2 id="Graph-Attention-Networks（GAT）"><a href="#Graph-Attention-Networks（GAT）" class="headerlink" title="Graph Attention Networks（GAT）"></a>Graph Attention Networks（GAT）</h2><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m62xxe5j22bc1qiwt1.jpg">

<h3 id="GAT提出的原因"><a href="#GAT提出的原因" class="headerlink" title="GAT提出的原因"></a>GAT提出的原因</h3><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m62z6mbj22bc1qiwrz.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m63jtawj22bc1qianh.jpg">

<h3 id="Attention-Mechanism"><a href="#Attention-Mechanism" class="headerlink" title="Attention Mechanism"></a>Attention Mechanism</h3><p>byproduct：副产品</p>
<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m65625dj22bc1qin9n.jpg">

<p>注意力计算公式：<br>$$<br>e_{uv}=a(W_kh_u^{k-1},W_kh_v^{k-1})<br>$$</p>
<p>其中：</p>
<ul>
<li><p>$W_k$：transformation matrix</p>
</li>
<li><p>$a$：a function</p>
</li>
</ul>
<blockquote>
<p>老师乘机解释了一波为啥叫softmax叫softmax函数，赞。</p>
</blockquote>
<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m64m4yvj22bc1qi7h3.jpg">

<blockquote>
<p>agnostic：不可知论的。注意力函数可以有多种选择，而且它也可以拥有函数。</p>
</blockquote>
<h3 id="Properties-of-Attention-Mechanism"><a href="#Properties-of-Attention-Mechanism" class="headerlink" title="Properties of Attention Mechanism"></a>Properties of Attention Mechanism</h3><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m65huuqj22bc1qi4cl.jpg">

<p>我们能够同样用到没有见过的节点上面。</p>
<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6m6plkj22bc1qi1kz.jpg">

<h2 id="Practical-tips-and-demos"><a href="#Practical-tips-and-demos" class="headerlink" title="Practical tips and demos"></a>Practical tips and demos</h2><h3 id="Application：Pinterest"><a href="#Application：Pinterest" class="headerlink" title="Application：Pinterest"></a>Application：Pinterest</h3><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6yoyawj22bc1qiqv8.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6pfuu9j22bc1qi1kz.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m65cpqcj22bc1qijz7.jpg">

<p>在Pinterest上面，有两类节点：</p>
<ul>
<li>一类节点叫做<strong>Pin</strong>（类似于收藏的物品，Pin的特征包括文字，图片，链接）；</li>
<li>一类节点叫做<strong>Board</strong>，类似于收藏夹。</li>
</ul>
<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m68ddfhj22bc1qib29.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m67wc64j22bc1qiqu8.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6b8popj22bc1qib29.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6owoy6j22bc1qi7wj.jpg">

<h4 id="创新点"><a href="#创新点" class="headerlink" title="创新点"></a>创新点</h4><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m684065j22bc1qi7f0.jpg">

<h5 id="动态图卷积"><a href="#动态图卷积" class="headerlink" title="动态图卷积"></a>动态图卷积</h5><p>不进行全图的节点训练</p>
<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m67weqbj22bc1qiav9.jpg">

<h5 id="基于random-walk进行邻居选择"><a href="#基于random-walk进行邻居选择" class="headerlink" title="基于random walk进行邻居选择"></a>基于random walk进行邻居选择</h5><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m68eu48j22bc1qi16e.jpg">

<h5 id="实验效果"><a href="#实验效果" class="headerlink" title="实验效果"></a>实验效果</h5><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6blhmxj22bc1qi4d4.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6wbw6ej22bc1qi4qs.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6qdv1mj22bc1qiqv6.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6t71e6j22bc1qi1kz.jpg">

<h3 id="Jure大佬给大家的实践经验⭐⭐⭐⭐⭐"><a href="#Jure大佬给大家的实践经验⭐⭐⭐⭐⭐" class="headerlink" title="Jure大佬给大家的实践经验⭐⭐⭐⭐⭐"></a>Jure大佬给大家的实践经验⭐⭐⭐⭐⭐</h3><img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m69uxo3j22bc1qin6w.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6aa4f7j22bc1qitjn.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6i5wf4j22bc1qie81.jpg">

<img src="http://ww1.sinaimg.cn/mw690/9b63ed6fgy1gl2m6ieyl2j22bc1qix6p.jpg">

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/112087612">知乎——cs224w 8.1-Graph Neural Network</a></li>
<li><a href="https://link.zhihu.com/?target=https://blog.csdn.net/weixin_43330946/article/details/102802768">CSDN——GNN之常用矩阵汇总</a></li>
</ol>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">CarlYoung</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://yc1999.github.io/2020/11/26/si-tan-fu-cs224w-tu-ji-qi-xue-xi-8-graph-neural-networks/">http://yc1999.github.io/2020/11/26/si-tan-fu-cs224w-tu-ji-qi-xue-xi-8-graph-neural-networks/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">CarlYoung</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/GNN/">
                                    <span class="chip bg-color">GNN</span>
                                </a>
                            
                                <a href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">课程笔记</span>
                                </a>
                            
                                <a href="/tags/cs224w/">
                                    <span class="chip bg-color">cs224w</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/11/28/paddlepaddle-she-ji-si-xiang/">
                    <div class="card-image">
                        
                        <img src="http://ww1.sinaimg.cn/large/9b63ed6fgy1gl9vk5tx86j20xc0m8769.jpg" class="responsive-img" alt="PaddlePaddle设计思想">
                        
                        <span class="card-title">PaddlePaddle设计思想</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
转载自PaddlePaddle官方文档

简介本篇文档主要介绍飞桨（PaddlePaddle，以下简称Paddle）底层的设计思想，帮助用户更好的理解框架运作过程。
阅读本文档，您将了解：

Paddle 内部的执行流程
Program 
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-11-28
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/PaddlePaddle/" class="post-category">
                                    PaddlePaddle
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%BD%AC%E8%BD%BD/">
                        <span class="chip bg-color">转载</span>
                    </a>
                    
                    <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">学习笔记</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/11/25/si-tan-fu-cs224w-tu-ji-qi-xue-xi-7-graph-representation-learning/">
                    <div class="card-image">
                        
                        <img src="http://ww1.sinaimg.cn/large/9b63ed6fgy1gkra5zwiqdj20w60eljsn.jpg" class="responsive-img" alt="【斯坦福cs224w-图机器学习】7-Graph-Representation-Learning">
                        
                        <span class="card-title">【斯坦福cs224w-图机器学习】7-Graph-Representation-Learning</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            讲解Shallow Node Embedding——DeepWalk、node2vec
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-11-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/GNN/" class="post-category">
                                    GNN
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/GNN/">
                        <span class="chip bg-color">GNN</span>
                    </a>
                    
                    <a href="/tags/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">课程笔记</span>
                    </a>
                    
                    <a href="/tags/cs224w/">
                        <span class="chip bg-color">cs224w</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="/about" target="_blank">CarlYoung</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/yc1999" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:yc1043301600@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
